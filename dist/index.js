import "./__farm_runtime.7ae4e502.mjs";import "./index_0686.409c7f51.js";import "./index_20f4.dd6c1b33.js";import "./index_2e43.c3c90867.js";import "./index_4118.3654c917.js";import "./index_6899.d5548a10.js";import "./index_7ec5.e9d186ff.js";import "./index_af7a.9498f467.js";import "./index_bb0a.80f6503a.js";import "./index_cb3a.d1f1037b.js";import "./index_d684.c9ddf561.js";import "./index_e15c.23f10619.js";import "./index_fda8.2783af0e.js";import * as __farm_external_module_fs from "fs";(globalThis || window || global)['650c7debb79582d1916d16c65fb3085a'].__farm_module_system__.setExternalModules({"fs": __farm_external_module_fs && __farm_external_module_fs.default && !__farm_external_module_fs.__esModule ? {...__farm_external_module_fs,__esModule:true} : __farm_external_module_fs});(function(_){for(var r in _){_[r].__farm_resource_pot__='index_172f.js';(globalThis || window || global)['650c7debb79582d1916d16c65fb3085a'].__farm_module_system__.register(r,_[r])}})({"953dfae2":function e(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"run",{enumerable:!0,get:function(){return l;}});let i=r("@swc/helpers/_/_interop_require_default"),c=r("@swc/helpers/_/_interop_require_wildcard")._(r("29bf5eaf")),n=i._(r("fs")),s=r("cfbad0c2");async function l(){try{let e="/home/runner/work";process.chdir("..");let t=process.cwd();n.default.mkdir(`${e}/dist`,async()=>{await (0,s.cloneRepo)(),await (0,s.pnpmInstall)(),await (0,s.buildProducts)(),await (0,s.generateViteTemplate)({rootDir:e,currentDir:t}),await (0,s.uploadArtifact)(e);});}catch(e){e instanceof Error&&c.setFailed(e.message);}}l();},"cfbad0c2":function e(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]});}(t,{buildProducts:function(){return f;},cloneRepo:function(){return u;},generateViteTemplate:function(){return m;},pnpmInstall:function(){return d;},uploadArtifact:function(){return g;}});let n=i("@swc/helpers/_/_interop_require_default"),r=i("@swc/helpers/_/_interop_require_wildcard"),l=r._(i("29bf5eaf")),s=i("6fca8cd7"),c=r._(i("5ba0ffaf")),o=n._(i("fs")),p=r._(i("1b2f3bda")),u=async()=>{l.startGroup("clone repo");try{let e=await (0,s.exec)("git",["init"]);await (0,s.exec)("git",["remote","add","origin","https://github.com/Tencent/tdesign-starter-cli"]),await (0,s.exec)("git",["fetch","--depth=1","origin","develop"]),await (0,s.exec)("git",["checkout","develop"]),0!==e&&l.setFailed("clone repo failed"),l.info("clone repo success");}catch(e){e instanceof Error&&l.setFailed(e.message);}l.endGroup();},d=async()=>{l.startGroup("install pnpm");try{let e=await (0,s.exec)("npm install pnpm -g");0!==e&&l.setFailed("pnpm install failed"),l.info("install pnpm success");}catch(e){e instanceof Error&&l.setFailed(e.message);}l.endGroup();},f=async()=>{l.startGroup("build dist");try{let e=await (0,s.exec)("pnpm install"),t=await (0,s.exec)("pnpm run build");(0!==t||0!==e)&&l.setFailed("build failed"),l.info("build success");}catch(e){e instanceof Error&&l.setFailed(e.message);}l.endGroup();},m=async({rootDir:e,currentDir:t})=>{l.startGroup("generate vite template");try{await (0,s.exec)("pnpm run dev init template-vite-vue3 --description 这是一个vite构建的vue3项目 --type vue3 --template lite --buildToolType vite");let i=await c.create("template-vite-*/vite.config.*");(await i.glob()).map(async i=>{let a=i.match(/template-vite-(.*)\//);if(null===a){l.setFailed("templateName is null");return;}l.info(`templateName: ${a[0]}`);let n=o.default.readFileSync(i,"utf-8").replace("defineConfig({",`defineConfig({
 base: '/tdesign-starter-cli/${a[0]}',`);l.info(`newViteConfig: ${n}`),o.default.writeFileSync(i,n),l.info(`当前目录: ${t}`);let r=`${t}/${a[0]}`;process.chdir(r),await (0,s.exec)("pnpm install"),await (0,s.exec)("pnpm run build"),await o.default.promises.mkdir(`${e}/dist/${a[0]}`,{recursive:!0}),await o.default.promises.cp(`${r}dist`,`${e}/dist/${a[0]}`);});}catch(e){e instanceof Error&&l.setFailed(e.message);}l.endGroup();},g=async e=>{l.startGroup("upload artifact");try{let t=new p.DefaultArtifactClient,i=await c.create(`${e}/dist/**`,{followSymbolicLinks:!1}),a=await i.glob(),{id:n,size:r}=await t.uploadArtifact("github-pages",a,e);if(!n||!r)throw Error("Artifact size is undefined");return l.info(`upload artifact success, id: ${n}, size: ${r}`),{id:n,size:r};}catch(e){throw e instanceof Error&&l.setFailed(e.message),e;}};},});(globalThis || window || global)['650c7debb79582d1916d16c65fb3085a'].__farm_module_system__.setInitialLoadedResources(['index_0686.409c7f51.js','index_20f4.dd6c1b33.js','index_2e43.c3c90867.js','index_4118.3654c917.js','index_6899.d5548a10.js','index_7ec5.e9d186ff.js','index_af7a.9498f467.js','index_bb0a.80f6503a.js','index_cb3a.d1f1037b.js','index_d684.c9ddf561.js','index_e15c.23f10619.js','index_fda8.2783af0e.js']);(globalThis || window || global)['650c7debb79582d1916d16c65fb3085a'].__farm_module_system__.setDynamicModuleResourcesMap({  });var farmModuleSystem = (globalThis || window || global)['650c7debb79582d1916d16c65fb3085a'].__farm_module_system__;farmModuleSystem.bootstrap();var entry = farmModuleSystem.require("953dfae2");var run=entry.run;export { run };
//# sourceMappingURL=index.js.map